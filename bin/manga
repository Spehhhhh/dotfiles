#!/usr/bin/env bash

# git clone https://github.com/zyddnys/manga-image-translator.git
# python3 -m venv .venv && source .venv/bin/activate && python3 -m pip install --upgrade
# pip install -r requirements.txt
# pip install git+https://github.com/lucasb-eyer/pydensecrf.git
# brew install freetype

if [ "$1" == "-h" ]; then
    echo "Usage: $(basename "$0") </YOUR_DIR>"
    exit 0
fi

MANGA_DIR="$PWD/$1"
FOLDER_PATH="$HOME/Stacks/Utilities/Manga/manga-image-translator"
PYTHON_EXEC="$FOLDER_PATH/.venv/bin/python"
ARGS=(
    "--verbose"
    "--mode=batch"
    "--translator=gpt3.5"
    "--target-lang=CHS"
    "--input=$MANGA_DIR"
)

echo "Translating $MANGA_DIR"
export DYLD_LIBRARY_PATH="$HOMEBREW_PREFIX/lib:$DYLD_LIBRARY_PATH"

cd "$FOLDER_PATH" && $PYTHON_EXEC -m manga_translator "${ARGS[@]}"
